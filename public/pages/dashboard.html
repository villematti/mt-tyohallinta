<div class="col-md-12">
<h2>Welcome to your dashboard!</h2>
<h3>{{ 'START_WORKING' | translate }}</h3>
	<div class="form-group">
		<label>Select a project:</label>
		<select class="form-control" ng-model="selectedProject">
			<option ng-if="project.statusId.name !== 'Done'" ng-repeat="project in 	allProjects" value="{{ project._id }}">{{ project.name }}</option>
		</select>
	</div>
	<div class="form-inline">
		<div class="form-group">
			<label for="bigvisit" class="label-control">Big visit?</label>
			<input id="bigvisit" type="checkbox" ng-model="bigVisit" />
		</div>
		<div class="form-group">
			<label for="tasktype" class="control-label">Tasktype</label>
			<select id="tasktype" class="form-control" ng-model="selectedTaskType">
				<option ng-repeat="taskType in taskTypes" value="{{ taskType._id }}">{{ taskType.name }}</option>
			</select>
		</div>
		<div class="form-group">
			<button class="btn btn-primary form-control" ng-click="startTask()">Start Task</button>
		</div>
	</div>

	<h3>Current Task</h3>
	<ul ng-if="usersTasks.lenght !== 0" class="list-group" ng-repeat="task in usersTasks">
		<div ng-if="task.endedAt === null" class="list-group-item">
			<h4 class="list-group-item-heading">{{ task.projectId.name }}</h4>
			<p class="list-group-item-text">
				<b>Started: </b>{{ task.createdAt | date: "dd-MM-yyyy HH:mm" }}
				<b>Big visit? </b>
				<input ng-disabled="true" ng-if="!task.bigVisit" type="checkbox" />
				<input ng-disabled="true" ng-if="task.bigVisit" type="checkbox" checked />
			</p>
			<p class="list-group-item-text">
				<button ng-click="endTask(task)" class="btn btn-warning">End Task </button>
				<label>Dirty Work: </label>
				<input size="4" type="text" ng-model="taskValues.dirtyWork" />
				<label>Machine Time: </label>
				<input size="4" type="text" ng-model="taskValues.machineTime" />
				<label>Overtime: </label>
				<input size="4" type="text" ng-model="taskValues.overtime" />
			</p>
		</div>
	</ul>

	<h3>Past Tasks</h3>
	<div ng-if="usersTasks.lenght === 0" class="alert alert-info">You have never worked.</div>
	<ul ng-if="usersTasks.lenght !== 0" class="list-group" dir-paginate="task in usersTasks | orderBy: 'createdAt':true | itemsPerPage: 5">
		<a ng-if="task.endedAt !== null" href="#/tasks/{{ task._id }}" class="list-group-item">
			<h4 class="list-group-item-heading">{{ task.projectId.name }}</h4>
			<p class="list-group-item-text">
				<b>Started: </b>{{ task.createdAt | date: "dd-MM-yyyy HH:mm" }}
				<b>Ended: </b>{{ task.endedAt | date: "dd-MM-yyyy HH:mm" }}
			</p>
			<p class="list-group-item-text">
				<b>Big visit? </b>
				<input ng-disabled="true" ng-if="!task.bigVisit" type="checkbox" />
				<input ng-disabled="true" ng-if="task.bigVisit" type="checkbox" checked />
				<span><b>Hours: </b>{{ task.hours | number: 1 }}h</span>
				<span ng-if="task.machineTime !== null"><b>Machine time: </b>{{ task.machineTime | number: 1 }}h</span>
				<span ng-if="task.dirtyWork !== null"><b>Dirty work: </b>{{ task.dirtyWork | number: 1 }}h</span>
				<span ng-if="task.overtime !== null"><b>Overtime: </b>{{ task.overtime | number: 1 }}h</span>
			</p>
		</a>
	</ul>
	<dir-pagination-controls></dir-pagination-controls>
</div>

<md-content class="col-md-12" style="margin-bottom: 25px;">
	
	<h3>Search Tasks With Date Range</h3>
	<div class="col-md-5">
		<label>Start date:</label><br />
		<md-datepicker ng-model="startDate" md-placeholder="Enter date"></md-datepicker>
	</div>
	<div class="col-md-5">
		<label>End date: </label><br />
		<md-datepicker ng-model="endDate" md-placeholder="Enter date"></md-datepicker>
	</div>
	<div class="col-md-2">
		<button style="margin-top: 29px;" class="btn btn-primary btn-sm" ng-click="getUsersTasksAtRange()">Get Tasks</button>
	</div>
</md-content>
<div ng-if="notFound == true" class="alert alert-warning col-md-12">No results found...</div>
<table ng-if="tasksOnRange.length !== 0" class="table">
	<thead>
		<tr>
			<th>Start Time</th>
			<th>End Time</th>
			<th>Hours</th>
			<th>Project name</th>
			<th>Big Visit</th>
			<th>Dirty Work</th>
			<th>Machine Time</th>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="task in tasksOnRange">
			<td>{{ task.createdAt | date: "dd-MM HH:mm" }}</td>
			<td>{{ task.endedAt | date: "dd-MM HH:mm" }}</td>
			<td>{{ task.hours | number: 1 }} h</td>
			<td>{{ task.projectId.name }}</td>
			<td>
				<input ng-disabled="true" ng-if="!task.bigVisit" type="checkbox" />
				<input ng-disabled="true" ng-if="task.bigVisit" type="checkbox" checked />
			</td>
			<td>{{ task.dirtyWork }}</td>
			<td>{{ task.machineTime }}</td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td><b>Total: {{ totalHours | number: 1 }}h</b></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
	</tbody>
</tabel>
</div>